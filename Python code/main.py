from tile import *
from map import *
import copy
import random
import csv

#region All tiles
t1 = Tile([(0,0),(3,0),(3,3),(0,3),(1,0),(2,0),(0,1),(0,2),(1,3),(2,3),(3,1),(3,2)], 
        [(8, 9), (1, 10), (10, 11), (1, 5), (2, 9), 
        (6, 7), (2, 11), (7, 8), (4, 5), (0, 4), (3, 7), (5, 10), (4, 6), 
        (9, 11), (0, 6), (3, 8), (7, 11), (6, 10), (7, 10), (8, 11), (5, 6)], 
        [12,11,7,13])

t2 = Tile([(0,0),(3,0),(3,3),(0,3),(1,0),(2,0),(0,1),(0,2),(1,3),(2,3),(3,1),(3,2),(1.5,2.5),(1.5,0.5)], 
        [(8, 9), (7, 12), (1, 10), (10, 11), (1, 5), (2, 9), (5, 13), (6, 7), 
         (10, 13), (8, 12), (2, 11), (7, 8), (4, 5), (0, 4), (3, 7), (6, 10), (5, 10), 
         (4, 6), (9, 11), (9, 12), (0, 6), (3, 8), (4, 13),(11, 12),(7, 11),(7, 10),(6, 13)], 
        [24,15,6,22,9,19])

t3 = Tile([(3.0, 0.0), (3.0, 3.0), (0.0, 3.0), (0.0, 0.0), (3.0, 1.0), (3.0, 2.0), (2.0, 0.0), (1.0, 0.0), (0.0, 1.0), (0.0, 2.0), (2.0, 3.0), (1.0, 3.0), (0.5, 1.5), (2.5, 1.5)],
          [(8, 9), (7, 12), (1, 10), (10, 11), (1, 5), (2, 9), (5, 13), (6, 7), 
         (10, 13), (8, 12), (2, 11), (7, 8), (4, 5), (0, 4), (3, 7), (6, 10), (5, 10), 
         (4, 6), (9, 11), (9, 12), (0, 6), (3, 8), (4, 13),(11, 12),(7, 11),(7, 10),(6, 13)], 
        [24,15,6,22,9,19])

t4 = Tile([(0.0,0.0),(3.0,0.0),(3.0,3.0),(0.0,3.0),(1.0,0.0),(2.0,0.0),(0.0,1.0),(0.0,2.0),(1.0,3.0),(2.0,3.0),(3.0,1.0),(3.0,2.0),(1.5,0.5)],
          [(8, 9), (1, 10), (10, 11), (2, 9), (5, 12), (1, 5), (10, 12), (6, 7), 
           (2, 11), (7, 8), (4, 5), (0, 4), (3, 7), (6, 12), (5, 10), (4, 6), (9, 11), 
           (0, 6), (3, 8), (4, 12), (6, 10), (7, 11), (7, 10), (8, 11)],
           [20,19,4,9,16])

t5 = Tile([(0.0, 3.0), (0.0, 0.0), (3.0, 0.0), (3.0, 3.0), (0.0, 2.0), (0.0, 1.0), (1.0, 3.0), (2.0, 3.0), (3.0, 2.0), (3.0, 1.0), (1.0, 0.0), (2.0, 0.0), (0.5, 1.5)],
          [(8, 9), (1, 10), (10, 11), (2, 9), (5, 12), (1, 5), (10, 12), (6, 7), 
           (2, 11), (7, 8), (4, 5), (0, 4), (3, 7), (6, 12), (5, 10), (4, 6), (9, 11), 
           (0, 6), (3, 8), (4, 12), (6, 10), (7, 11), (7, 10), (8, 11)],
           [20,19,4,9,16])

t6 = Tile([(3.0, 3.0), (0.0, 3.0), (0.0, 0.0), (3.0, 0.0), (2.0, 3.0), (1.0, 3.0), (3.0, 2.0), (3.0, 1.0), (2.0, 0.0), (1.0, 0.0), (0.0, 2.0), (0.0, 1.0), (1.5, 2.5)],
          [(8, 9), (1, 10), (10, 11), (2, 9), (5, 12), (1, 5), (10, 12), (6, 7), 
           (2, 11), (7, 8), (4, 5), (0, 4), (3, 7), (6, 12), (5, 10), (4, 6), (9, 11), 
           (0, 6), (3, 8), (4, 12), (6, 10), (7, 11), (7, 10), (8, 11)],
           [20,19,4,9,16])

t7 = Tile([(3.0, 0.0), (3.0, 3.0), (0.0, 3.0), (0.0, 0.0), (3.0, 1.0), (3.0, 2.0), (2.0, 0.0), (1.0, 0.0), (0.0, 1.0), (0.0, 2.0), (2.0, 3.0), (1.0, 3.0), (2.5, 1.5)],
          [(8, 9), (1, 10), (10, 11), (2, 9), (5, 12), (1, 5), (10, 12), (6, 7), 
           (2, 11), (7, 8), (4, 5), (0, 4), (3, 7), (6, 12), (5, 10), (4, 6), (9, 11), 
           (0, 6), (3, 8), (4, 12), (6, 10), (7, 11), (7, 10), (8, 11)],
           [20,19,4,9,16])

t8 = Tile([(0.0,0.0),(3.0,0.0),(3.0,3.0),(0.0,3.0),(1.0,0.0),(2.0,0.0),(0.0,1.0),(0.0,2.0),(1.0,3.0),(2.0,3.0),(3.0,1.0),(3.0,2.0),(1.5,2.5),(2.5,1.5)],
          [(11, 13), (7, 12), (8, 9), (1, 10), (10, 11), (2, 9), (1, 5), (5, 13), (6, 7), (10, 13), 
           (8, 12), (2, 11), (7, 8), (0, 4), (3, 7), (5, 10), (4, 6), (9, 11), (12, 13), 
           (9, 12), (9, 13), (0, 6), (3, 8), (4, 5), (5, 7), (4, 7), (5, 12)],
           [24,16,10,19,0,9])

t9 = Tile([(3.0, 3.0), (0.0, 3.0), (0.0, 0.0), (3.0, 0.0), (2.0, 3.0), (1.0, 3.0), (3.0, 2.0), (3.0, 1.0), (2.0, 0.0), (1.0, 0.0), (0.0, 2.0), (0.0, 1.0), (1.5, 0.5), (0.5, 1.5)],
          [(11, 13), (7, 12), (8, 9), (1, 10), (10, 11), (2, 9), (1, 5), (5, 13), (6, 7), (10, 13), 
           (8, 12), (2, 11), (7, 8), (0, 4), (3, 7), (5, 10), (4, 6), (9, 11), (12, 13), 
           (9, 12), (9, 13), (0, 6), (3, 8), (4, 5), (5, 7), (4, 7), (5, 12)],
           [24,16,10,19,0,9])

t10 = Tile([(3.0, 0.0), (3.0, 3.0), (0.0, 3.0), (0.0, 0.0), (3.0, 1.0), (3.0, 2.0), (2.0, 0.0), (1.0, 0.0), (0.0, 1.0), (0.0, 2.0), (2.0, 3.0), (1.0, 3.0), (0.5, 1.5), (1.5, 2.5)],
           [(11, 13), (7, 12), (8, 9), (1, 10), (10, 11), (2, 9), (1, 5), (5, 13), (6, 7), (10, 13), 
           (8, 12), (2, 11), (7, 8), (0, 4), (3, 7), (5, 10), (4, 6), (9, 11), (12, 13), 
           (9, 12), (9, 13), (0, 6), (3, 8), (4, 5), (5, 7), (4, 7), (5, 12)],
           [24,16,10,19,0,9])

t11 = Tile([(0.0, 3.0), (0.0, 0.0), (3.0, 0.0), (3.0, 3.0), (0.0, 2.0), (0.0, 1.0), (1.0, 3.0), (2.0, 3.0), (3.0, 2.0), (3.0, 1.0), (1.0, 0.0), (2.0, 0.0), (2.5, 1.5), (1.5, 0.5)],
           [(11, 13), (7, 12), (8, 9), (1, 10), (10, 11), (2, 9), (1, 5), (5, 13), (6, 7), (10, 13), 
           (8, 12), (2, 11), (7, 8), (0, 4), (3, 7), (5, 10), (4, 6), (9, 11), (12, 13), 
           (9, 12), (9, 13), (0, 6), (3, 8), (4, 5), (5, 7), (4, 7), (5, 12)],
           [24,16,10,19,0,9])

t12 = Tile([(0.0, 3.0), (0.0, 0.0), (3.0, 0.0), (3.0, 3.0), (0.0, 2.0), (0.0, 1.0), (1.0, 3.0), (2.0, 3.0), (3.0, 2.0), (3.0, 1.0), (1.0, 0.0), (2.0, 0.0)],
           [(8, 9), (1, 10), (10, 11), (2, 9), (1, 5), (6, 7),
           (2, 11), (7, 8), (0, 4), (3, 7), (5, 10), (4, 6), (9, 11), 
           (0, 6), (3, 8), (4, 5), (5, 7), (4, 7), (8, 10), (9, 10), (5, 8)],
           [18,12,11,16])

t13 = Tile([(0.0, 0.0), (3.0, 0.0), (3.0, 3.0), (0.0, 3.0), (1.0, 0.0), (2.0, 0.0), (0.0, 1.0), (0.0, 2.0), (1.0, 3.0), (2.0, 3.0), (3.0, 1.0), (3.0, 2.0)],
           [(8, 9), (1, 10), (10, 11), (2, 9), (1, 5), (6, 7),
           (2, 11), (7, 8), (0, 4), (3, 7), (5, 10), (4, 6), (9, 11), 
           (0, 6), (3, 8), (4, 5), (5, 7), (4, 7), (8, 10), (9, 10), (5, 8)],
           [18,12,11,16])

t14 = Tile([(0.0,0.0),(3.0,0.0),(3.0,3.0),(0.0,3.0),(1.0,0.0),(2.0,0.0),(0.0,1.0),(0.0,2.0),(1.0,3.0),(2.0,3.0),(3.0,1.0),(3.0,2.0),(1.5,0.5),(1.5,2.5),(0.5,1.5),(2.5,1.5)],
           [(7, 14), (8, 9), (1, 10), (10, 11), (2, 9), (5, 12), (1, 5), (8, 14), (6, 7), (11, 15), (2, 11), 
            (7, 8), (13, 14), (8, 13), (4, 5), (5, 15), (6, 14), (0, 4), (10, 15), (3, 7), (13, 15), (5, 10), 
            (4, 6), (12, 14), (9, 11), (12, 13), (9, 13), (0, 6), (4, 14), (12, 15), (3, 8), (4, 12), (9, 15)],
            [5,31,13,26,0,16,9,18])
#endregion

l = [t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14] # List of all tiles

mask = [0,1,2,3,4,5,6,7,8,9,10,11,12,13] # Mask of all tiles
mask_set = set()
random.seed(50)

map = Map(7, 2, "torus")

for j in range(map.m):
    for i in range(map.n):
        t = copy.copy(l[mask[i+j*7]])
        map.setTile(t, i, j)

# Neighbours are set after all tiles are placed
map.updateNeighbours()
map.plot(color=True)

"""
while True:
    random.shuffle(mask)
    mask_tuple = tuple(mask)
    if mask_tuple in mask_set:
        continue
    
    mask_set.add(mask_tuple)

    plane = Map(7, 2, "plane")   # Possible types: "plane", "cylinder", "torus"
    cylinder = Map(7, 2, "cylinder")
    torus = Map(7, 2, "torus")

    for j in range(plane.m):
        for i in range(plane.n):
            t = copy.copy(l[mask[i+j*7]])
            plane.setTile(t, i, j)

            t = copy.copy(l[mask[i+j*7]])
            cylinder.setTile(t, i, j)

            t = copy.copy(l[mask[i+j*7]])
            torus.setTile(t, i, j)

    # Neighbours are set after all tiles are placed
    plane.updateNeighbours()  
    cylinder.updateNeighbours()
    torus.updateNeighbours()

    # Open a CSV file in write mode
    with open('plane.csv', mode='a', newline='') as file:
        writer = csv.writer(file)

        plane_1d = plane.count_1d_components()
        loops = plane_1d[0]
        open_path = plane_1d[1]
        components_1d = plane_1d[2]

        plane_2d = plane.count_2d_components()
        water = plane_2d[0]
        land = plane_2d[1]
        components_2d = plane_2d[2]

        # Write the data
        writer.writerow([loops, open_path, components_1d, water, land, components_2d, mask_tuple])

    # Open a CSV file in write mode
    with open('cylinder.csv', mode='a', newline='') as file:
        writer = csv.writer(file)

        plane_1d = cylinder.count_1d_components()
        loops = plane_1d[0]
        open_path = plane_1d[1]
        components_1d = plane_1d[2]

        plane_2d = cylinder.count_2d_components()
        water = plane_2d[0]
        land = plane_2d[1]
        components_2d = plane_2d[2]

        # Write the data
        writer.writerow([loops, open_path, components_1d, water, land, components_2d, mask_tuple])

    # Open a CSV file in write mode
    with open('torus.csv', mode='a', newline='') as file:
        writer = csv.writer(file)

        plane_1d = torus.count_1d_components()
        loops = plane_1d[0]
        open_path = plane_1d[1]
        components_1d = plane_1d[2]

        plane_2d = torus.count_2d_components()
        water = plane_2d[0]
        land = plane_2d[1]
        components_2d = plane_2d[2]

        # Write the data
        writer.writerow([loops, open_path, components_1d, water, land, components_2d, mask_tuple])
"""


